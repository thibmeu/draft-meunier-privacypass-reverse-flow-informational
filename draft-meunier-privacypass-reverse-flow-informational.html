<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Privacy Pass Reverse Flow</title>
<meta content="Thibault Meunier" name="author">
<meta content="
       This document specifies an instantiation of Privacy Pass Architecture  
that allows for a reverse flow from the Origin to the Client/Attester/Issuer.
It describes the conceptual model of Privacy Pass reverse flow and its protocols,
its security and privacy goals, practical deployment models, and recommendations
for each deployment model, to help ensure that the desired security and privacy
goals are fulfilled. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="draft-meunier-privacypass-reverse-flow-informational-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-meunier-privacypass-reverse-flow-informational.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Privacy Pass Reverse Flow</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Meunier</td>
<td class="center">Expires 21 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Privacy Pass</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-meunier-privacypass-reverse-flow-informational-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-18" class="published">18 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-21">21 June 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Meunier</div>
<div class="org">Cloudflare Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Privacy Pass Reverse Flow</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies an instantiation of Privacy Pass Architecture <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>
that allows for a reverse flow from the Origin to the Client/Attester/Issuer.
It describes the conceptual model of Privacy Pass reverse flow and its protocols,
its security and privacy goals, practical deployment models, and recommendations
for each deployment model, to help ensure that the desired security and privacy
goals are fulfilled.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://thibmeu.github.io/draft-meunier-privacypass-reverse-flow-informational/draft-meunier-privacypass-reverse-flow-informational.html">https://thibmeu.github.io/draft-meunier-privacypass-reverse-flow-informational/draft-meunier-privacypass-reverse-flow-informational.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-meunier-privacypass-reverse-flow-informational/">https://datatracker.ietf.org/doc/draft-meunier-privacypass-reverse-flow-informational/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Privacy Pass Working Group mailing list (<span><a href="mailto:privacy-pass@ietf.org">mailto:privacy-pass@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/privacy-pass/">https://mailarchive.ietf.org/arch/browse/privacy-pass/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/privacy-pass/">https://www.ietf.org/mailman/listinfo/privacy-pass/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/thibmeu/draft-meunier-privacypass-reverse-flow-informational">https://github.com/thibmeu/draft-meunier-privacypass-reverse-flow-informational</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-client-behaviour" class="internal xref">Client behaviour</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-origin-issuer-attester-depl" class="internal xref">Origin/Issuer/Attester deployment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-split-origin-attester-deplo" class="internal xref">Split Origin-Attester deployment</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-issuer-face-values" class="internal xref">Issuer face values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-token-for-specific-clients" class="internal xref">Token for specific Clients</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-sending-multiple-tokens" class="internal xref">Sending multiple tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-swap-endpoint-and-its-priva" class="internal xref">Swap endpoint and its privacy implication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies an instantiation of Privacy Pass Architecture <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>
that allows for a reverse flow from the Origin to the Client/Attester/Issuer.
In other words, it specifies a way for the Origin to act as a joint Attester/Issuer.
A Client that has already been authorised to access an Origin can maintain that access,
without losing the unlinkable property provided by Privacy Pass. In addition, it allows
an Origin to define its own issuance policy based on an initial bootstraping attestation
method. For instance, an Origin that wants to grant 30 access for users that solved a
CAPTCHA might consume a type 0x0002 public veriable token, and use it to issue 30 type
0x0001 private tokens.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">We reuse terminology from <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">New terminology is defined below<a href="#section-2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-4">
        <dt id="section-2-4.1">Flow:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.2">
          <p id="section-2-4.2.1">Direction from PrivateToken issuance to its redemption. The entity starting the flow acts as an Issuer, while the end of the flow acts as an Origin. The Client is always included, as it finalises the TokenResponse, and coordinate interactions.<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.3">Initial Flow:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.4">
          <p id="section-2-4.4.1">Issuer -&gt; Attester -&gt; Client -&gt; Origin. This flow produces a PrivateToken that is used by the Origin to kickstart a Reverse Flow.<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.5">Reverse Flow:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.6">
          <p id="section-2-4.6.1">Issuer &lt;- Attester &lt;- Client &lt;- Origin. This flow allows Origin to issues PrivateToken. In the reverse flow, the Origin operates one or more Issuer, and the Client <span class="bcp14">MAY</span> provide these tokens either to the Initial Attester/Issuer, or use them against the Origin<a href="#section-2-4.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.7">Initial Attester/Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.8">
          <p id="section-2-4.8.1">Attester/Issuer part of the Initial Flow<a href="#section-2-4.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.9">Origin Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.10">
          <p id="section-2-4.10.1">Issuer operated by the Origin<a href="#section-2-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.11">Origin PrivateToken:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.12">
          <p id="section-2-4.12.1">PrivateToken issued by the Origin<a href="#section-2-4.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.13">Reverse Origin:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.14">
          <p id="section-2-4.14.1">An entity that consumes the Origin PrivateToken. It can be the Origin, or the Initial Attester/Issuer<a href="#section-2-4.14.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol overview</a>
      </h2>
<p id="section-3-1">Along with sending their PrivateToken for authentication (as specified in RFC9576), Client
sends TokenRequest<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="section-3-2">
        <div class="alignLeft art-svg artwork" id="section-3-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="904" viewBox="0 0 904 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
            <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
            <path d="M 40,64 L 40,256" fill="none" stroke="black"></path>
            <path d="M 136,32 L 136,64" fill="none" stroke="black"></path>
            <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
            <path d="M 208,64 L 208,256" fill="none" stroke="black"></path>
            <path d="M 248,32 L 248,64" fill="none" stroke="black"></path>
            <path d="M 568,32 L 568,64" fill="none" stroke="black"></path>
            <path d="M 600,64 L 600,256" fill="none" stroke="black"></path>
            <path d="M 640,32 L 640,64" fill="none" stroke="black"></path>
            <path d="M 720,32 L 720,64" fill="none" stroke="black"></path>
            <path d="M 760,64 L 760,144" fill="none" stroke="black"></path>
            <path d="M 760,192 L 760,256" fill="none" stroke="black"></path>
            <path d="M 808,32 L 808,64" fill="none" stroke="black"></path>
            <path d="M 824,32 L 824,64" fill="none" stroke="black"></path>
            <path d="M 856,64 L 856,256" fill="none" stroke="black"></path>
            <path d="M 896,32 L 896,64" fill="none" stroke="black"></path>
            <path d="M 8,32 L 136,32" fill="none" stroke="black"></path>
            <path d="M 176,32 L 248,32" fill="none" stroke="black"></path>
            <path d="M 568,32 L 640,32" fill="none" stroke="black"></path>
            <path d="M 720,32 L 808,32" fill="none" stroke="black"></path>
            <path d="M 824,32 L 896,32" fill="none" stroke="black"></path>
            <path d="M 8,64 L 136,64" fill="none" stroke="black"></path>
            <path d="M 176,64 L 248,64" fill="none" stroke="black"></path>
            <path d="M 568,64 L 640,64" fill="none" stroke="black"></path>
            <path d="M 720,64 L 808,64" fill="none" stroke="black"></path>
            <path d="M 824,64 L 896,64" fill="none" stroke="black"></path>
            <path d="M 216,96 L 256,96" fill="none" stroke="black"></path>
            <path d="M 336,96 L 600,96" fill="none" stroke="black"></path>
            <path d="M 208,112 L 224,112" fill="none" stroke="black"></path>
            <path d="M 432,112 L 592,112" fill="none" stroke="black"></path>
            <path d="M 608,126 L 624,126" fill="none" stroke="black"></path>
            <path d="M 608,130 L 624,130" fill="none" stroke="black"></path>
            <path d="M 736,126 L 752,126" fill="none" stroke="black"></path>
            <path d="M 736,130 L 752,130" fill="none" stroke="black"></path>
            <path d="M 600,160 L 672,160" fill="none" stroke="black"></path>
            <path d="M 792,160 L 848,160" fill="none" stroke="black"></path>
            <path d="M 608,176 L 672,176" fill="none" stroke="black"></path>
            <path d="M 800,176 L 856,176" fill="none" stroke="black"></path>
            <path d="M 216,192 L 232,192" fill="none" stroke="black"></path>
            <path d="M 584,192 L 600,192" fill="none" stroke="black"></path>
            <path d="M 48,208 L 64,208" fill="none" stroke="black"></path>
            <path d="M 184,208 L 208,208" fill="none" stroke="black"></path>
            <path d="M 40,224 L 56,224" fill="none" stroke="black"></path>
            <path d="M 184,224 L 200,224" fill="none" stroke="black"></path>
            <path d="M 216,240 L 232,240" fill="none" stroke="black"></path>
            <path d="M 552,240 L 592,240" fill="none" stroke="black"></path>
            <polygon class="arrowhead" points="856,160 844,154.4 844,165.6" fill="black" transform="rotate(0,848,160)"></polygon>
            <polygon class="arrowhead" points="760,128 748,122.4 748,133.6" fill="black" transform="rotate(0,752,128)"></polygon>
            <polygon class="arrowhead" points="616,176 604,170.4 604,181.6" fill="black" transform="rotate(180,608,176)"></polygon>
            <polygon class="arrowhead" points="616,128 604,122.4 604,133.6" fill="black" transform="rotate(180,608,128)"></polygon>
            <polygon class="arrowhead" points="600,240 588,234.4 588,245.6" fill="black" transform="rotate(0,592,240)"></polygon>
            <polygon class="arrowhead" points="600,112 588,106.4 588,117.6" fill="black" transform="rotate(0,592,112)"></polygon>
            <polygon class="arrowhead" points="224,192 212,186.4 212,197.6" fill="black" transform="rotate(180,216,192)"></polygon>
            <polygon class="arrowhead" points="224,96 212,90.4 212,101.6" fill="black" transform="rotate(180,216,96)"></polygon>
            <polygon class="arrowhead" points="208,224 196,218.4 196,229.6" fill="black" transform="rotate(0,200,224)"></polygon>
            <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
            <g class="text">
              <text x="44" y="52">Origin</text>
              <text x="100" y="52">Issuer</text>
              <text x="212" y="52">Origin</text>
              <text x="604" y="52">Client</text>
              <text x="764" y="52">Attester</text>
              <text x="860" y="52">Issuer</text>
              <text x="296" y="100">Request</text>
              <text x="292" y="116">TokenChallenge</text>
              <text x="388" y="116">(Issuer)</text>
              <text x="680" y="132">Attestation</text>
              <text x="732" y="164">TokenRequest</text>
              <text x="736" y="180">TokenResponse</text>
              <text x="376" y="196">Request+Token+TokenRequest(Origin</text>
              <text x="544" y="196">Issuer)</text>
              <text x="124" y="212">TokenRequest</text>
              <text x="120" y="228">TokenResponse</text>
              <text x="360" y="244">Response+TokenResponse(Origin</text>
              <text x="512" y="244">Issuer)</text>
            </g>
          </svg><a href="#section-3-2.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-3-3">The initial flow matches the one defined by <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>. A Client gets challenged when
accessing a resource on an Origin. The Client goes to the Attester to get issue a Token.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Through configuration mechanism not defined in this document, the Client is aware the Origin
acts as a Reverse Flow issuer.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">This is an extension of <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>. The Client sends Request+Token+TokenRequest(Origin Issuer).
The Origin runs the issuance protocol based, and returns Response+TokenResponse(Origin Issuer).<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">TokenRequest(Origin Issuer) and TokenResponse(Origin Issuer) happen through a new HTTP Header <code>PrivacyPass-Reverse</code>.
<code>PrivacyPass-Reverse</code> is a base64url encoded binary encoded HTTP message, respectively per <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> and <span>[<a href="#RFC9292" class="cite xref">RFC9292</a>]</span>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3-7.1">
          <p id="section-3-7.1.1">The use of binary encoding avoids the definition of a new ad-hoc encoding of request, response, and
associated errors for each Privacy Pass issuance protocols. This matches the architecture as defined in <span>[<a href="#RFC9576" class="cite xref">RFC9576</a>]</span>.<a href="#section-3-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="client-behaviour">
<section id="section-3.1">
        <h3 id="name-client-behaviour">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-client-behaviour" class="section-name selfRef">Client behaviour</a>
        </h3>
<p id="section-3.1-1">Along with sending PrivateToken from the Initial Issuer to the Origin, the Client sends one TokenRequest as defined in <span>[<a href="#RFC9578" class="cite xref">RFC9578</a>]</span> or draft-batched-tokens.
The Client <span class="bcp14">SHOULD</span> consider Privacy Pass Reverse Flow like the initial flow. The Client
is responsible to coordinate between the different entities.
Specifically, if the Reverse Origin is the Initial Attester/Issuer, the Client <span class="bcp14">SHOULD</span>
account for possible privacy leakage.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="originissuerattester-deployment">
<section id="section-3.2">
        <h3 id="name-origin-issuer-attester-depl">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-origin-issuer-attester-depl" class="section-name selfRef">Origin/Issuer/Attester deployment</a>
        </h3>
<p id="section-3.2-1">In this model, the Origin, Attester, and Issuer are all operated by the same
entity, as shown in <a href="#fig-deploy-shared" class="auto internal xref">Figure 1</a>. The Reverse Flow is the same as
the Initial Flow, except for the request/response encapsulation.
The Origin is the Reverse Origin.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-shared-deployment-model"></span><div id="fig-deploy-shared">
<figure id="figure-1">
          <div id="section-3.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-3.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="528" viewBox="0 0 528 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,256" fill="none" stroke="black"></path>
                <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
                <path d="M 144,32 L 144,80" fill="none" stroke="black"></path>
                <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
                <path d="M 216,80 L 216,104" fill="none" stroke="black"></path>
                <path d="M 216,120 L 216,160" fill="none" stroke="black"></path>
                <path d="M 256,48 L 256,80" fill="none" stroke="black"></path>
                <path d="M 304,48 L 304,80" fill="none" stroke="black"></path>
                <path d="M 344,80 L 344,96" fill="none" stroke="black"></path>
                <path d="M 344,128 L 344,192" fill="none" stroke="black"></path>
                <path d="M 376,48 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,48 L 424,80" fill="none" stroke="black"></path>
                <path d="M 456,80 L 456,256" fill="none" stroke="black"></path>
                <path d="M 496,48 L 496,80" fill="none" stroke="black"></path>
                <path d="M 520,48 L 520,80" fill="none" stroke="black"></path>
                <path d="M 144,32 L 504,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
                <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
                <path d="M 304,48 L 376,48" fill="none" stroke="black"></path>
                <path d="M 424,48 L 496,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 168,80 L 256,80" fill="none" stroke="black"></path>
                <path d="M 304,80 L 376,80" fill="none" stroke="black"></path>
                <path d="M 424,80 L 496,80" fill="none" stroke="black"></path>
                <path d="M 160,96 L 208,96" fill="none" stroke="black"></path>
                <path d="M 224,96 L 336,96" fill="none" stroke="black"></path>
                <path d="M 352,96 L 448,96" fill="none" stroke="black"></path>
                <path d="M 464,96 L 504,96" fill="none" stroke="black"></path>
                <path d="M 48,112 L 232,112" fill="none" stroke="black"></path>
                <path d="M 440,112 L 456,112" fill="none" stroke="black"></path>
                <path d="M 48,142 L 72,142" fill="none" stroke="black"></path>
                <path d="M 48,146 L 72,146" fill="none" stroke="black"></path>
                <path d="M 184,142 L 208,142" fill="none" stroke="black"></path>
                <path d="M 184,146 L 208,146" fill="none" stroke="black"></path>
                <path d="M 40,176 L 128,176" fill="none" stroke="black"></path>
                <path d="M 248,176 L 336,176" fill="none" stroke="black"></path>
                <path d="M 48,192 L 128,192" fill="none" stroke="black"></path>
                <path d="M 256,192 L 344,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 96,224" fill="none" stroke="black"></path>
                <path d="M 384,224 L 448,224" fill="none" stroke="black"></path>
                <path d="M 48,240 L 120,240" fill="none" stroke="black"></path>
                <path d="M 368,240 L 448,240" fill="none" stroke="black"></path>
                <path d="M 504,32 C 512.83064,32 520,39.16936 520,48" fill="none" stroke="black"></path>
                <path d="M 160,96 C 151.16936,96 144,88.83064 144,80" fill="none" stroke="black"></path>
                <path d="M 504,96 C 512.83064,96 520,88.83064 520,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="456,224 444,218.4 444,229.6" fill="black" transform="rotate(0,448,224)"></polygon>
                <polygon class="arrowhead" points="344,176 332,170.4 332,181.6" fill="black" transform="rotate(0,336,176)"></polygon>
                <polygon class="arrowhead" points="216,144 204,138.4 204,149.6" fill="black" transform="rotate(0,208,144)"></polygon>
                <polygon class="arrowhead" points="56,240 44,234.4 44,245.6" fill="black" transform="rotate(180,48,240)"></polygon>
                <polygon class="arrowhead" points="56,192 44,186.4 44,197.6" fill="black" transform="rotate(180,48,192)"></polygon>
                <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
                <polygon class="arrowhead" points="56,112 44,106.4 44,117.6" fill="black" transform="rotate(180,48,112)"></polygon>
                <g class="text">
                  <text x="44" y="68">Client</text>
                  <text x="212" y="68">Attester</text>
                  <text x="340" y="68">Issuer</text>
                  <text x="460" y="68">Origin</text>
                  <text x="300" y="116">TokenChallenge</text>
                  <text x="396" y="116">(Issuer)</text>
                  <text x="128" y="148">Attestation</text>
                  <text x="188" y="180">TokenRequest</text>
                  <text x="192" y="196">TokenResponse</text>
                  <text x="208" y="228">Token+TokenRequest(Origin</text>
                  <text x="344" y="228">Issuer)</text>
                  <text x="212" y="244">TokenResponse(Origin</text>
                  <text x="328" y="244">Issuer)</text>
                </g>
              </svg><a href="#section-3.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-shared-deployment-model" class="selfRef">Shared Deployment Model</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">Similar to the original Shared Deployment Model, the Attester,
Issuer, and Origin share the attestation, issuance, and redemption
contexts. Even if this context changes between the Initial and
Reverse Flow, attestation mechanism that can uniquely identify
a Client are not appropriate as they could lead to unlinkability violations.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="split-origin-attester-deployment">
<section id="section-3.3">
        <h3 id="name-split-origin-attester-deplo">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-split-origin-attester-deplo" class="section-name selfRef">Split Origin-Attester deployment</a>
        </h3>
<p id="section-3.3-1">In this model, the Attester and Issuer are operated by the same entity
that is separate from the Origin. The Origin trusts the joint Attester
and Issuer to perform attestation and issue Tokens.
Origin Tokens can then be sent by Client on new requests, as long as the
Reverse Origin trusts the Origin to perform attestation and issue Tokens.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-joint-attester-and-issuer-d"></span><div id="fig-deploy-joint-issuer">
<figure id="figure-2">
          <div id="section-3.3-2.1">
            <div class="alignLeft art-svg artwork" id="section-3.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="920" viewBox="0 0 920 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,256" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                <path d="M 176,48 L 176,80" fill="none" stroke="black"></path>
                <path d="M 208,80 L 208,256" fill="none" stroke="black"></path>
                <path d="M 248,48 L 248,80" fill="none" stroke="black"></path>
                <path d="M 568,48 L 568,80" fill="none" stroke="black"></path>
                <path d="M 600,80 L 600,256" fill="none" stroke="black"></path>
                <path d="M 640,48 L 640,80" fill="none" stroke="black"></path>
                <path d="M 688,32 L 688,80" fill="none" stroke="black"></path>
                <path d="M 712,48 L 712,80" fill="none" stroke="black"></path>
                <path d="M 760,80 L 760,144" fill="none" stroke="black"></path>
                <path d="M 760,192 L 760,256" fill="none" stroke="black"></path>
                <path d="M 800,48 L 800,80" fill="none" stroke="black"></path>
                <path d="M 816,48 L 816,80" fill="none" stroke="black"></path>
                <path d="M 856,80 L 856,256" fill="none" stroke="black"></path>
                <path d="M 888,48 L 888,80" fill="none" stroke="black"></path>
                <path d="M 912,48 L 912,80" fill="none" stroke="black"></path>
                <path d="M 688,32 L 896,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 136,48" fill="none" stroke="black"></path>
                <path d="M 176,48 L 248,48" fill="none" stroke="black"></path>
                <path d="M 568,48 L 640,48" fill="none" stroke="black"></path>
                <path d="M 712,48 L 800,48" fill="none" stroke="black"></path>
                <path d="M 816,48 L 888,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 136,80" fill="none" stroke="black"></path>
                <path d="M 176,80 L 248,80" fill="none" stroke="black"></path>
                <path d="M 568,80 L 640,80" fill="none" stroke="black"></path>
                <path d="M 712,80 L 800,80" fill="none" stroke="black"></path>
                <path d="M 816,80 L 888,80" fill="none" stroke="black"></path>
                <path d="M 704,96 L 752,96" fill="none" stroke="black"></path>
                <path d="M 768,96 L 848,96" fill="none" stroke="black"></path>
                <path d="M 864,96 L 896,96" fill="none" stroke="black"></path>
                <path d="M 208,112 L 224,112" fill="none" stroke="black"></path>
                <path d="M 432,112 L 592,112" fill="none" stroke="black"></path>
                <path d="M 608,126 L 624,126" fill="none" stroke="black"></path>
                <path d="M 608,130 L 624,130" fill="none" stroke="black"></path>
                <path d="M 736,126 L 752,126" fill="none" stroke="black"></path>
                <path d="M 736,130 L 752,130" fill="none" stroke="black"></path>
                <path d="M 600,160 L 672,160" fill="none" stroke="black"></path>
                <path d="M 792,160 L 848,160" fill="none" stroke="black"></path>
                <path d="M 608,176 L 672,176" fill="none" stroke="black"></path>
                <path d="M 800,176 L 856,176" fill="none" stroke="black"></path>
                <path d="M 216,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 584,192 L 600,192" fill="none" stroke="black"></path>
                <path d="M 48,208 L 64,208" fill="none" stroke="black"></path>
                <path d="M 184,208 L 208,208" fill="none" stroke="black"></path>
                <path d="M 40,224 L 56,224" fill="none" stroke="black"></path>
                <path d="M 184,224 L 200,224" fill="none" stroke="black"></path>
                <path d="M 216,240 L 232,240" fill="none" stroke="black"></path>
                <path d="M 552,240 L 592,240" fill="none" stroke="black"></path>
                <path d="M 896,32 C 904.83064,32 912,39.16936 912,48" fill="none" stroke="black"></path>
                <path d="M 704,96 C 695.16936,96 688,88.83064 688,80" fill="none" stroke="black"></path>
                <path d="M 896,96 C 904.83064,96 912,88.83064 912,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="856,160 844,154.4 844,165.6" fill="black" transform="rotate(0,848,160)"></polygon>
                <polygon class="arrowhead" points="760,128 748,122.4 748,133.6" fill="black" transform="rotate(0,752,128)"></polygon>
                <polygon class="arrowhead" points="616,176 604,170.4 604,181.6" fill="black" transform="rotate(180,608,176)"></polygon>
                <polygon class="arrowhead" points="616,128 604,122.4 604,133.6" fill="black" transform="rotate(180,608,128)"></polygon>
                <polygon class="arrowhead" points="600,240 588,234.4 588,245.6" fill="black" transform="rotate(0,592,240)"></polygon>
                <polygon class="arrowhead" points="600,112 588,106.4 588,117.6" fill="black" transform="rotate(0,592,112)"></polygon>
                <polygon class="arrowhead" points="224,192 212,186.4 212,197.6" fill="black" transform="rotate(180,216,192)"></polygon>
                <polygon class="arrowhead" points="208,224 196,218.4 196,229.6" fill="black" transform="rotate(0,200,224)"></polygon>
                <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
                <g class="text">
                  <text x="44" y="68">Origin</text>
                  <text x="100" y="68">Issuer</text>
                  <text x="212" y="68">Origin</text>
                  <text x="604" y="68">Client</text>
                  <text x="756" y="68">Attester</text>
                  <text x="852" y="68">Issuer</text>
                  <text x="292" y="116">TokenChallenge</text>
                  <text x="388" y="116">(Issuer)</text>
                  <text x="680" y="132">Attestation</text>
                  <text x="732" y="164">TokenRequest</text>
                  <text x="736" y="180">TokenResponse</text>
                  <text x="376" y="196">Request+Token+TokenRequest(Origin</text>
                  <text x="544" y="196">Issuer)</text>
                  <text x="124" y="212">TokenRequest</text>
                  <text x="120" y="228">TokenResponse</text>
                  <text x="360" y="244">Response+TokenResponse(Origin</text>
                  <text x="512" y="244">Issuer)</text>
                </g>
              </svg><a href="#section-3.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-joint-attester-and-issuer-d" class="selfRef">Joint Attester and Issuer Deployment Model</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">The Origin Issuer <span class="bcp14">MUST</span> not issue privately verifiable tokens, as this would
lead to secret material being shared between the Origin and the Reverse Origin.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">A particular deployment model is when the Reverse Origin is the Attester/Issuer.
This model is described in <a href="#fig-deploy-joint-issuer-reserve" class="auto internal xref">Figure 3</a><a href="#section-3.3-4" class="pilcrow">¶</a></p>
<span id="name-joint-attester-and-issuer-de"></span><div id="fig-deploy-joint-issuer-reserve">
<figure id="figure-3">
          <div id="section-3.3-5.1">
            <div class="alignLeft art-svg artwork" id="section-3.3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="920" viewBox="0 0 920 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 40,80 L 40,272" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                <path d="M 176,48 L 176,80" fill="none" stroke="black"></path>
                <path d="M 208,80 L 208,272" fill="none" stroke="black"></path>
                <path d="M 248,48 L 248,80" fill="none" stroke="black"></path>
                <path d="M 568,48 L 568,80" fill="none" stroke="black"></path>
                <path d="M 600,80 L 600,272" fill="none" stroke="black"></path>
                <path d="M 640,48 L 640,80" fill="none" stroke="black"></path>
                <path d="M 688,32 L 688,80" fill="none" stroke="black"></path>
                <path d="M 712,48 L 712,80" fill="none" stroke="black"></path>
                <path d="M 760,80 L 760,144" fill="none" stroke="black"></path>
                <path d="M 760,192 L 760,248" fill="none" stroke="black"></path>
                <path d="M 800,48 L 800,80" fill="none" stroke="black"></path>
                <path d="M 816,48 L 816,80" fill="none" stroke="black"></path>
                <path d="M 856,80 L 856,272" fill="none" stroke="black"></path>
                <path d="M 888,48 L 888,80" fill="none" stroke="black"></path>
                <path d="M 912,48 L 912,80" fill="none" stroke="black"></path>
                <path d="M 688,32 L 896,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 136,48" fill="none" stroke="black"></path>
                <path d="M 176,48 L 248,48" fill="none" stroke="black"></path>
                <path d="M 568,48 L 640,48" fill="none" stroke="black"></path>
                <path d="M 712,48 L 800,48" fill="none" stroke="black"></path>
                <path d="M 816,48 L 888,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 136,80" fill="none" stroke="black"></path>
                <path d="M 176,80 L 248,80" fill="none" stroke="black"></path>
                <path d="M 568,80 L 640,80" fill="none" stroke="black"></path>
                <path d="M 712,80 L 800,80" fill="none" stroke="black"></path>
                <path d="M 816,80 L 888,80" fill="none" stroke="black"></path>
                <path d="M 704,96 L 752,96" fill="none" stroke="black"></path>
                <path d="M 768,96 L 848,96" fill="none" stroke="black"></path>
                <path d="M 864,96 L 896,96" fill="none" stroke="black"></path>
                <path d="M 208,112 L 224,112" fill="none" stroke="black"></path>
                <path d="M 432,112 L 592,112" fill="none" stroke="black"></path>
                <path d="M 608,126 L 624,126" fill="none" stroke="black"></path>
                <path d="M 608,130 L 624,130" fill="none" stroke="black"></path>
                <path d="M 736,126 L 752,126" fill="none" stroke="black"></path>
                <path d="M 736,130 L 752,130" fill="none" stroke="black"></path>
                <path d="M 600,160 L 672,160" fill="none" stroke="black"></path>
                <path d="M 792,160 L 848,160" fill="none" stroke="black"></path>
                <path d="M 608,176 L 672,176" fill="none" stroke="black"></path>
                <path d="M 800,176 L 856,176" fill="none" stroke="black"></path>
                <path d="M 216,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 584,192 L 600,192" fill="none" stroke="black"></path>
                <path d="M 48,208 L 64,208" fill="none" stroke="black"></path>
                <path d="M 184,208 L 208,208" fill="none" stroke="black"></path>
                <path d="M 40,224 L 56,224" fill="none" stroke="black"></path>
                <path d="M 184,224 L 200,224" fill="none" stroke="black"></path>
                <path d="M 216,240 L 232,240" fill="none" stroke="black"></path>
                <path d="M 552,240 L 592,240" fill="none" stroke="black"></path>
                <path d="M 600,256 L 696,256" fill="none" stroke="black"></path>
                <path d="M 760,256 L 848,256" fill="none" stroke="black"></path>
                <path d="M 896,32 C 904.83064,32 912,39.16936 912,48" fill="none" stroke="black"></path>
                <path d="M 704,96 C 695.16936,96 688,88.83064 688,80" fill="none" stroke="black"></path>
                <path d="M 896,96 C 904.83064,96 912,88.83064 912,80" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="856,256 844,250.4 844,261.6" fill="black" transform="rotate(0,848,256)"></polygon>
                <polygon class="arrowhead" points="856,160 844,154.4 844,165.6" fill="black" transform="rotate(0,848,160)"></polygon>
                <polygon class="arrowhead" points="760,128 748,122.4 748,133.6" fill="black" transform="rotate(0,752,128)"></polygon>
                <polygon class="arrowhead" points="616,176 604,170.4 604,181.6" fill="black" transform="rotate(180,608,176)"></polygon>
                <polygon class="arrowhead" points="616,128 604,122.4 604,133.6" fill="black" transform="rotate(180,608,128)"></polygon>
                <polygon class="arrowhead" points="600,240 588,234.4 588,245.6" fill="black" transform="rotate(0,592,240)"></polygon>
                <polygon class="arrowhead" points="600,112 588,106.4 588,117.6" fill="black" transform="rotate(0,592,112)"></polygon>
                <polygon class="arrowhead" points="224,192 212,186.4 212,197.6" fill="black" transform="rotate(180,216,192)"></polygon>
                <polygon class="arrowhead" points="208,224 196,218.4 196,229.6" fill="black" transform="rotate(0,200,224)"></polygon>
                <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
                <g class="text">
                  <text x="44" y="68">Origin</text>
                  <text x="100" y="68">Issuer</text>
                  <text x="212" y="68">Origin</text>
                  <text x="604" y="68">Client</text>
                  <text x="756" y="68">Attester</text>
                  <text x="852" y="68">Issuer</text>
                  <text x="292" y="116">TokenChallenge</text>
                  <text x="388" y="116">(Issuer)</text>
                  <text x="680" y="132">Attestation</text>
                  <text x="732" y="164">TokenRequest</text>
                  <text x="736" y="180">TokenResponse</text>
                  <text x="376" y="196">Request+Token+TokenRequest(Origin</text>
                  <text x="544" y="196">Issuer)</text>
                  <text x="124" y="212">TokenRequest</text>
                  <text x="120" y="228">TokenResponse</text>
                  <text x="360" y="244">Response+TokenResponse(Origin</text>
                  <text x="512" y="244">Issuer)</text>
                  <text x="728" y="260">Token</text>
                  <text x="760" y="276">|</text>
                </g>
              </svg><a href="#section-3.3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-joint-attester-and-issuer-de" class="selfRef">Joint Attester and Issuer Deployment Model with reverse</a>
          </figcaption></figure>
</div>
<p id="section-3.3-6">This deployment <span class="bcp14">SHOULD</span> not allow the Reverse Origin to infer the request made
to the Origin, as it would break unlinkability.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-4">
      <h2 id="name-privacy-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-4-1">Privacy Pass RFC 9576 states<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-2.1">
          <p id="section-4-2.1.1">In general, limiting the amount of metadata permitted helps limit the extent to which metadata can uniquely identify individual Clients. Failure to bound the number of possible metadata values can therefore lead to a reduction in Client privacy. Most token types do not admit any metadata, so this bound is implicitly enforced.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">In privacy pass with a reverse flow, users are provided with new PrivateTokens depending on their request. They can spend these tokens to continue making further requests.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">While the token are still unlinkable, the token_key_id associated to them represent metadata. It leaks some information about the Client. The following subsections discuss the issues that influence the anonymity set, and possible mitigation/safeguards to protect against this underlying problem.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="issuer-face-values">
<section id="section-4.1">
        <h3 id="name-issuer-face-values">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-issuer-face-values" class="section-name selfRef">Issuer face values</a>
        </h3>
<p id="section-4.1-1">When setting up a reverse flow deployment, an Origin <span class="bcp14">MAY</span> setup up multiple Issuers, and assign them some metadata to them. The amount of possible metadata grows as 2^(origin_issuers).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">We RECOMMEND that:
1. Origin defines their anonimity sets, and deploy no more than log2(#anonimity_sets). This bounds the possible anonimity sets by design.
2. Client to only send 1 PrivateToken per request. This is inline with RFC9577 and RFC (Web Authentication) which only allows one challenge response to be provided as part of Authorization HTTP header.
3. Issuers metadata to be publicly disclosed via an origin endpoint, and externally monitored<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-for-specific-clients">
<section id="section-4.2">
        <h3 id="name-token-for-specific-clients">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-token-for-specific-clients" class="section-name selfRef">Token for specific Clients</a>
        </h3>
<p id="section-4.2-1">In Privacy Pass with a reverse flow, the Origin <span class="bcp14">MAY</span> operate multiple Issuers, with arbitrary metadata associated to them. A malicious Origin <span class="bcp14">MAY</span> uses this opportunity to associate certain token values to a specific set of Clients.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Let's consider the following deployment: the Origin operates two issuers A and B. The Client sends Token_A, and (TokenRequest_A, TokenRequest_B). Issuer B is associated to a croissant aficionados.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">If a Client requests croissant, or sends Token_B, the origin will provide TokenResponse_B. If not, it provides TokenResponse_A.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Over time, this means the Origin is able to track croissants aficionados.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">To mitigate this, we RECOMMEND:
1. The initial PrivateToken to be provided by an Issuer not in control of the Origin. The joint Origin/Attester/Issuer model <span class="bcp14">SHOULD NOT</span> be used.
2. Clients to reset their state regularly with the initial Issuer.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-multiple-tokens">
<section id="section-4.3">
        <h3 id="name-sending-multiple-tokens">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-sending-multiple-tokens" class="section-name selfRef">Sending multiple tokens</a>
        </h3>
<p id="section-4.3-1">While that's not part of Privacy Pass with a reverse flow, some deployment might consider allowing Clients to send multiple PrivateToken, similar to how normal Privacy Pass deployment could allow two distinct PrivateToken to be sent.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">In Privacy Pass with a reverse flow deployment, there are as many bits as Issuers; each token is one bit. We RECOMMEND to have a maximum of 6 Origin operated Issuers, bounding Client information to 2^6 = 64. Accounting for the initial Issuer, this means a total of log2(64)+1=7 issuers.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Origin should have sufficient traffic to not single-out particular Client based on timings of requests.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="swap-endpoint-and-its-privacy-implication">
<section id="section-4.4">
        <h3 id="name-swap-endpoint-and-its-priva">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-swap-endpoint-and-its-priva" class="section-name selfRef">Swap endpoint and its privacy implication</a>
        </h3>
<p id="section-4.4-1">With multiple Issuers, a Client <span class="bcp14">MAY</span> end up with a bunch of tokens, for various Issuers. Origins MIGHT propose a swap endpoint at which a Client can use to exchange one or more Origin tokens against one or more Origin token.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The Origin <span class="bcp14">SHOULD</span> ensure the traffic is important enough on this endpoint to not reduce the anonymity sets.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-6">
      <h2 id="name-normative-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9292">[RFC9292]</dt>
      <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Binary Representation of HTTP Messages"</span>, <span class="seriesInfo">RFC 9292</span>, <span class="seriesInfo">DOI 10.17487/RFC9292</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9292">https://www.rfc-editor.org/rfc/rfc9292</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9576">[RFC9576]</dt>
      <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Iyengar, J.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-architecture-16</span>, <time datetime="2023-09-25" class="refDate">25 September 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-architecture-16">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-architecture-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9578">[RFC9578]</dt>
    <dd>
<span class="refAuthor">Celi, S.</span>, <span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocols"</span>, <span class="seriesInfo">RFC 9578</span>, <span class="seriesInfo">DOI 10.17487/RFC9578</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9578">https://www.rfc-editor.org/rfc/rfc9578</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thibault Meunier</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ot-ietf@thibault.uk" class="email">ot-ietf@thibault.uk</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
